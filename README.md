             .___              
           __| _/____     ____ 
          / __ |\__  \   / ___\
         / /_/ | / __ \_/ /_/  > 
         \____ |(____  /\___  /
              \/     \//_____/             

Overview
========

DAG is a Fortran 2018 library for creating and manipulating directed acyclic graphs (DAGs).  
DAG is based on a fork of [daglib by Jacob Williams], refactored to add

* A build system and test harness automated by [fpm],
* Unit testing written with [Vegetables], 
* Continuous-integration testing and documentation deployment via [GitHub Actions], 
* Documentation generated by [FORD], 
* Runtime assertion-checking using [Assert], and
* [JSON] file input/output using [jsonff].  

DAG includes a topological sort feature, and it generates files in the [GraphViz] "dot" format.

Prerequisites
-------------
DAG was developed with the following prerequisite package versions:

1. [gfortran] 10.2.0
2. [OpenCoarrays]  2.9.2
3. [fpm] 0.1.3
4. [graphviz] 2.44.1

Earlier versions might work also.

Building and testing
--------------------
After installing [fpm], clone, build, and test, execute the following in a `bash`-like shell:
```
git clone git@github.com:sourceryinstitute/dag
fpm test --compiler caf --runner "cafrun -n 1"
```
replacing `1` in the last line with the desired number of images to execute in parallel for
each test.  Also try compiling and running the example with
```
fpm run --example
```
Please report any test failures by submitting an [issue] on the DAG repository.

Example
-------

The [./example/feats-dependency-tree.f90] program provides an example of the use of dag to
describe the module dependencies in an early version of the Framework for Extensible Asynchronous 
Task Scheduling ([FEATS]).  The example also writes the following image to a `.pdf` file:

![feats-dependencies](https://user-images.githubusercontent.com/13108868/133311851-721b7cda-1d10-4ee1-a51d-6169ca624839.png)


License
-------

This library is released under a [BSD-3 license].

[daglib by Jacob Williams]: https://github.com/jacobwilliams/daglib
[GraphViz]: https://www.graphviz.org
[OpenCoarrays]: https://github.com/sourceryinstitute/opencoarrays
[CMake]: https://www.cmake.org
[gfortran]: https://gcc.gnu.org
[BSD-3 license]: https://github.com/sourceryinstitute/dag/blob/master/LICENSE
[fpm]: https://github.com/fortran-lang/fpm
[3276af]: https://github.com/everythingfunctional/fpm/commit/3276af2e000d1b2c90f151148cd01cce0d3e886d

[Vegetables]: https://gitlab.com/everythingfunctional/Vegetables
[GitHub Actions]: https://github.com/features/actions
[FORD]: https://github.com/Fortran-FOSS-Programmers/ford
[JSON]: https://www.json.org/json-en.html
[jsonff]: https://gitlab.com/everythingfunctional/jsonff
[./src/dag_test.f90]: ./src/dag_test.f90
[./example/feats-dependency-tree.f90]: ./example/feats-dependency-tree.f90
[FEATS]: https://github.com/sourceryinstitute/feats
[Assert]: https://github.com/sourceryinstitute/assert
